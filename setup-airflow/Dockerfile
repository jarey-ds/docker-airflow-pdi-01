FROM apache/airflow:2.9.2

USER root

RUN chmod -R 7777 /opt/airflow/
RUN mkdir -p /opt/airflow/logs/scheduler
RUN chmod 7777 /opt/airflow/logs/scheduler

# Install environment dependencies
RUN apt-get update \
# xmlstarlet package is required by Airflow to read XML log generated by Carte server running in separate container
    && apt-get install xmlstarlet -y
USER airflow
    # Upgrade PIP
RUN pip install --upgrade pip \
# Install project specific packages
    && pip install 'apache-airflow[postgres]'



